{"version":3,"sources":["webpack:///fireaction.js","webpack:///webpack/bootstrap 26aa397a93facf551e2c","webpack:///./lib/index.js","webpack:///./lib/init.js","webpack:///./lib/util/handler.js","webpack:///./lib/util/error.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","Fireaction","ref","this","_getFireData","src","child","once","then","srcSnap","value","val","key","_paste","srcData","dest","options","destRef","dataIsObject","override","set","update","_remove","remove","_init","copy","callback","move","window","init","noCallback","defaultHandler","withKey","error","replace","self","copiedData","returnData","catch","err","handler","res","Promise","reject","resolve","description","Error"],"mappings":"CAAS,SAAUA,GCInB,QAAAC,GAAAC,GAGA,GAAAC,EAAAD,GACA,MAAAC,GAAAD,GAAAE,OAGA,IAAAC,GAAAF,EAAAD,IACAI,EAAAJ,EACAK,GAAA,EACAH,WAUA,OANAJ,GAAAE,GAAAM,KAAAH,EAAAD,QAAAC,IAAAD,QAAAH,GAGAI,EAAAE,GAAA,EAGAF,EAAAD,QAvBA,GAAAD,KA4BAF,GAAAQ,EAAAT,EAGAC,EAAAS,EAAAP,EAGAF,EAAAU,EAAA,SAAAP,EAAAQ,EAAAC,GACAZ,EAAAa,EAAAV,EAAAQ,IACAG,OAAAC,eAAAZ,EAAAQ,GACAK,cAAA,EACAC,YAAA,EACAC,IAAAN,KAMAZ,EAAAmB,EAAA,SAAAf,GACA,GAAAQ,GAAAR,KAAAgB,WACA,WAA2B,MAAAhB,GAAA,SAC3B,WAAiC,MAAAA,GAEjC,OADAJ,GAAAU,EAAAE,EAAA,IAAAA,GACAA,GAIAZ,EAAAa,EAAA,SAAAQ,EAAAC,GAAsD,MAAAR,QAAAS,UAAAC,eAAAjB,KAAAc,EAAAC,IAGtDtB,EAAAyB,EAAA,GAGAzB,IAAA0B,EAAA,KDMM,SAAUtB,EAAQD,EAASH,GAEjC,YEnEA,MAAA2B,GAAA,SAAAC,GACAC,KAAAD,MAGAD,GAAAJ,UAAAO,aAAA,SAAAC,GACA,MAAAF,MAAAD,IAAAI,MAAAD,GAAAE,KAAA,SAAAC,KAAA,SAAAC,GACA,OACAC,MAAAD,EAAAE,MACAC,IAAAH,EAAAG,QAKAX,EAAAJ,UAAAgB,OAAA,SAAAC,EAAAC,EAAAC,GACAD,EAAAC,EAAA,QAAAD,EAAA,IAAAD,EAAAF,IAAAG,CACA,MAAAE,GAAAd,KAAAD,IAAAI,MAAAS,GACAG,EAAA,gBAAAJ,GAAAJ,KACA,OAAAM,GAAAG,WAAAD,EACAD,EAAAG,IAAAN,EAAAJ,OAEAO,EAAAI,OAAAP,EAAAJ,QAIAT,EAAAJ,UAAAyB,QAAA,SAAAjB,GACA,MAAAF,MAAAD,IAAAI,MAAAD,GAAAkB,UAGAtB,EAAAJ,UAAA2B,MAAAlD,EAAA,GAEA2B,EAAAJ,UAAA4B,KAAA,SAAApB,EAAAU,EAAAC,EAAAU,GACA,MAAAvB,MAAAqB,MAAAnB,EAAAU,EAAAC,EAAAU,IAGAzB,EAAAJ,UAAA8B,KAAA,SAAAtB,EAAAU,EAAAC,EAAAU,GACA,MAAAvB,MAAAqB,MAAAnB,EAAAU,EAAAC,EAAAU,GAAA,IAGA,mBAAAE,QACAA,OAAA3B,aAEAvB,EAAAD,QAAAwB,GFkFM,SAAUvB,EAAQD,EAASH,GAEjC,YGlHA,SAAAuD,GAAAxB,EAAAU,EAAAC,EAAAU,EAAAC,GACA,kBAAAX,IAAAU,IACAA,EAAAV,EACAA,KAEA,IAAAc,IAAA,CAMA,IALAJ,IAAAI,GAAA,GACAJ,KAAAK,EACAf,MAAwBgB,SAAA,EAAAb,UAAA,GAGxB,gBAAAd,GAAA,MAAAqB,GAAAO,EAAA,0CACA,oBAAAlB,GAAA,MAAAW,GAAAO,EAAA,gDAOA,IAJA5B,IAAA6B,QAAA,eAAAA,QAAA,eACAnB,IAAAmB,QAAA,eAAAA,QAAA,eAGA7B,IAAAU,EAAA,MAAAW,GAAAO,EAAA,0DAEA,IAAAnB,KACA,MAAAqB,GAAAhC,IAgCA,OA9BAA,MAAAC,aAAAC,GAEAG,KAAA,SAAA4B,GAEA,GADAtB,EAAAsB,EACA,OAAAA,EAAA1B,MACA,KAAAuB,GAAA,+CAEA,OAAAE,GAAAtB,OAAAC,EAAAC,EAAAC,KAGAR,KAAA,WACAmB,GAAAQ,EAAAb,QAAAjB,KAGAG,KAAA,WACA,GAAA6B,GAAAvB,EAAAJ,KAKA,OAJAM,GAAAgB,UACAK,KACAA,EAAAvB,EAAAF,KAAAE,EAAAJ,OAEAgB,EAAA,KAAAW,KAEAC,MAAA,SAAAC,GACA,GAAAT,EACA,KAAAS,EAEA,OAAAb,GAAAa,KA7DA,KAAAR,GAAAzD,EAAA,GACA2D,EAAA3D,EAAA,EAmEAI,GAAAD,QAAAoD,GHqIM,SAAUnD,EAAQD,EAASH,GAEjC,YI3MA,MAAAkE,GAAA,SAAAD,EAAAE,GACA,MAAAF,GACAG,QAAAC,OAAAJ,GAEAG,QAAAE,QAAAH,GAIA/D,GAAAD,QAAA+D,GJmNM,SAAU9D,EAAQD,EAASH,GAEjC,YK7NA,SAAA2D,GAAAhD,EAAA4D,GACA,KAAAN,GAAA,GAAAO,OAAAD,EAEA,OADAN,GAAAtD,OACAsD,EAGA7D,EAAAD,QAAAwD","file":"fireaction.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n // eslint-disable-line\n\nconst Fireaction = function (ref) {\n  this.ref = ref\n}\n\nFireaction.prototype._getFireData = function (src) {\n  return this.ref.child(src).once('value').then(function (srcSnap) {\n    return {\n      value: srcSnap.val(),\n      key: srcSnap.key\n    }\n  })\n}\n\nFireaction.prototype._paste = function (srcData, dest, options) {\n  dest = (options.withKey) ? dest + '/' + srcData.key : dest\n  const destRef = this.ref.child(dest)\n  const dataIsObject = (typeof srcData.value === 'object')\n  if (options.override || !dataIsObject) {\n    return destRef.set(srcData.value)\n  } else {\n    return destRef.update(srcData.value)\n  }\n}\n\nFireaction.prototype._remove = function (src) {\n  return this.ref.child(src).remove()\n}\n\nFireaction.prototype._init = __webpack_require__(1)\n\nFireaction.prototype.copy = function (src, dest, options, callback) {\n  return this._init(src, dest, options, callback)\n}\n\nFireaction.prototype.move = function (src, dest, options, callback) {\n  return this._init(src, dest, options, callback, true)\n}\n\nif (typeof window !== 'undefined') {\n  window.Fireaction = Fireaction\n} else {\n  module.exports = Fireaction\n}\n// if (typeof module !== 'undefined' && typeof module.exports !== 'undefined') {\n//   module.exports = Fireaction\n//   console.log(module, module.exports)\n// } else {\n//   console.log('Added to window');\n// }\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n // eslint-disable-line\n\nconst defaultHandler = __webpack_require__(2)\nconst error = __webpack_require__(3)\n\n/**\n * [description]\n * @param  {String}   src      [firebase path for copy source]\n * @param  {String}   dest     [firebase path copy destination]\n * @param  {Object}   options  [configuration for copying method]\n * @param  {Function} callback [callback function for async copy requests]\n * @return {Promise}            [given callback if any else resolved promise]\n */\nfunction init (src, dest, options, callback, move) {\n  if (typeof options === 'function' && !callback) {\n    callback = options\n    options = {}\n  }\n  var noCallback = false\n  if (!callback) noCallback = true\n  callback = callback || defaultHandler\n  options = options || { withKey: true, override: false }\n\n  // validate src and destination\n  if (typeof src !== 'string') return callback(error('srcType', 'source path must be a string'))\n  if (typeof dest !== 'string') return callback(error('destType', 'destination path must be a string'))\n\n  // remove trailing slashes from src path\n  src = src.replace(/^[/]+/gi, '').replace(/[/]+$/gi, '')\n  dest = dest.replace(/^[/]+/gi, '').replace(/[/]+$/gi, '')\n\n  // make sure source and destination are not the same\n  if (src === dest) return callback(error('samePath', 'source and destination must not be the same'))\n  // perform copy actions\n  var srcData = {}\n  const self = this\n  // get the data from src path\n  const responsePromise = this._getFireData(src)\n      // validate and copy to dest path\n      .then(function (copiedData) {\n        srcData = copiedData\n        if (copiedData.value === null) {\n          throw error('nullSrc', 'Source path value must not be null')\n        }\n        return self._paste(srcData, dest, options)\n      })\n      // remove from src path if method called is move\n      .then(function () {\n        if (move) self._remove(src)\n      })\n      // setup response data and return via callback\n      .then(function () {\n        var returnData = srcData.value\n        if (options.withKey) {\n          returnData = {}\n          returnData[srcData.key] = srcData.value\n        }\n        return callback(null, returnData)\n      })\n      .catch(function (err) {\n        if (noCallback) {\n          throw err\n        } else {\n          return callback(err)\n        }\n      })\n\n  return responsePromise\n}\n\nmodule.exports = init\n\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n // eslint-disable-line\n\nconst handler = function (err, res) {\n  if (err) {\n    return Promise.reject(err)\n  } else {\n    return Promise.resolve(res)\n  }\n}\n\nmodule.exports = handler\n\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n // eslint-disable-line\n\nfunction error (name, description) {\n  const err = new Error(description)\n  err.name = name\n  return err\n}\n\nmodule.exports = error\n\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// fireaction.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 26aa397a93facf551e2c","'use strict' // eslint-disable-line\n\nconst Fireaction = function (ref) {\n  this.ref = ref\n}\n\nFireaction.prototype._getFireData = function (src) {\n  return this.ref.child(src).once('value').then(function (srcSnap) {\n    return {\n      value: srcSnap.val(),\n      key: srcSnap.key\n    }\n  })\n}\n\nFireaction.prototype._paste = function (srcData, dest, options) {\n  dest = (options.withKey) ? dest + '/' + srcData.key : dest\n  const destRef = this.ref.child(dest)\n  const dataIsObject = (typeof srcData.value === 'object')\n  if (options.override || !dataIsObject) {\n    return destRef.set(srcData.value)\n  } else {\n    return destRef.update(srcData.value)\n  }\n}\n\nFireaction.prototype._remove = function (src) {\n  return this.ref.child(src).remove()\n}\n\nFireaction.prototype._init = require('./init')\n\nFireaction.prototype.copy = function (src, dest, options, callback) {\n  return this._init(src, dest, options, callback)\n}\n\nFireaction.prototype.move = function (src, dest, options, callback) {\n  return this._init(src, dest, options, callback, true)\n}\n\nif (typeof window !== 'undefined') {\n  window.Fireaction = Fireaction\n} else {\n  module.exports = Fireaction\n}\n// if (typeof module !== 'undefined' && typeof module.exports !== 'undefined') {\n//   module.exports = Fireaction\n//   console.log(module, module.exports)\n// } else {\n//   console.log('Added to window');\n// }\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/index.js\n// module id = 0\n// module chunks = 0","'use strict' // eslint-disable-line\n\nconst defaultHandler = require('./util/handler')\nconst error = require('./util/error')\n\n/**\n * [description]\n * @param  {String}   src      [firebase path for copy source]\n * @param  {String}   dest     [firebase path copy destination]\n * @param  {Object}   options  [configuration for copying method]\n * @param  {Function} callback [callback function for async copy requests]\n * @return {Promise}            [given callback if any else resolved promise]\n */\nfunction init (src, dest, options, callback, move) {\n  if (typeof options === 'function' && !callback) {\n    callback = options\n    options = {}\n  }\n  var noCallback = false\n  if (!callback) noCallback = true\n  callback = callback || defaultHandler\n  options = options || { withKey: true, override: false }\n\n  // validate src and destination\n  if (typeof src !== 'string') return callback(error('srcType', 'source path must be a string'))\n  if (typeof dest !== 'string') return callback(error('destType', 'destination path must be a string'))\n\n  // remove trailing slashes from src path\n  src = src.replace(/^[/]+/gi, '').replace(/[/]+$/gi, '')\n  dest = dest.replace(/^[/]+/gi, '').replace(/[/]+$/gi, '')\n\n  // make sure source and destination are not the same\n  if (src === dest) return callback(error('samePath', 'source and destination must not be the same'))\n  // perform copy actions\n  var srcData = {}\n  const self = this\n  // get the data from src path\n  const responsePromise = this._getFireData(src)\n      // validate and copy to dest path\n      .then(function (copiedData) {\n        srcData = copiedData\n        if (copiedData.value === null) {\n          throw error('nullSrc', 'Source path value must not be null')\n        }\n        return self._paste(srcData, dest, options)\n      })\n      // remove from src path if method called is move\n      .then(function () {\n        if (move) self._remove(src)\n      })\n      // setup response data and return via callback\n      .then(function () {\n        var returnData = srcData.value\n        if (options.withKey) {\n          returnData = {}\n          returnData[srcData.key] = srcData.value\n        }\n        return callback(null, returnData)\n      })\n      .catch(function (err) {\n        if (noCallback) {\n          throw err\n        } else {\n          return callback(err)\n        }\n      })\n\n  return responsePromise\n}\n\nmodule.exports = init\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/init.js\n// module id = 1\n// module chunks = 0","'use strict' // eslint-disable-line\n\nconst handler = function (err, res) {\n  if (err) {\n    return Promise.reject(err)\n  } else {\n    return Promise.resolve(res)\n  }\n}\n\nmodule.exports = handler\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/util/handler.js\n// module id = 2\n// module chunks = 0","'use strict' // eslint-disable-line\n\nfunction error (name, description) {\n  const err = new Error(description)\n  err.name = name\n  return err\n}\n\nmodule.exports = error\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/util/error.js\n// module id = 3\n// module chunks = 0"],"sourceRoot":""}